


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TorchScript 소개 &mdash; PyTorch Tutorials 1.6.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="C++에서 TorchScript 모델 로딩하기" href="../advanced/cpp_export.html" />
    <link rel="prev" title="Flask를 이용하여 Python에서 PyTorch를 REST API로 배포하기" href="../intermediate/flask_rest_api_tutorial.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<body class="pytorch-body">
  <nav class="navbar sticky-top navbar-dark fixed-top navbar-expand-lg" style="background: rgba(55,55,55,.8)">
    <div class="container-fluid">
      <div class="navbar-brand">
        <a href="https://pytorch.kr/" aria-label="PyTorch">
          <img src="../_static/images/logo-kr.svg" width="260" height="28" fill="white" />
        </a>
      </div>
      <button type="button" aria-label="Toggle navigation" class="navbar-toggler collapsed" aria-expanded="false" aria-controls="nav-collapse"><span class="navbar-toggler-icon"></span></button>
      <div id="nav-collapse" class="navbar-collapse collapse">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a href="//pytorch.kr/" target="_self" class="nav-link">홈</a></li>
          <li class="nav-item">
            <a href="//tutorials.pytorch.kr/" target="_self" class="nav-link">튜토리얼</a>
          </li>
          <li class="nav-item">
            <a href="//pytorch.kr/about" target="_self" class="nav-link">
              소개
            </a></li>
        </ul>
      </div>
    </div>
  </nav>

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  1.6.0
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Tutorials" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">파이토치(PyTorch) 레시피</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../recipes/recipes_index.html">모든 레시피 보기</a></li>
</ul>
<p class="caption"><span class="caption-text">파이토치(PyTorch) 배우기</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deep_learning_60min_blitz.html">파이토치(PyTorch)로 딥러닝하기: 60분만에 끝장내기</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch_with_examples.html">예제로 배우는 파이토치(PyTorch)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn_tutorial.html"><cite>torch.nn</cite> 이 <em>실제로</em> 무엇인가요?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/tensorboard_tutorial.html">TensorBoard로 모델, 데이터, 학습 시각화하기</a></li>
</ul>
<p class="caption"><span class="caption-text">이미지/비디오</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/torchvision_tutorial.html">TorchVision 객체 검출 미세조정(Finetuning) 튜토리얼</a></li>
<li class="toctree-l1"><a class="reference internal" href="transfer_learning_tutorial.html">컴퓨터 비전(Vision)을 위한 전이학습(Transfer Learning)</a></li>
<li class="toctree-l1"><a class="reference internal" href="fgsm_tutorial.html">적대적 예제 생성(Adversarial Example Generation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="dcgan_faces_tutorial.html">DCGAN Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">오디오</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="audio_preprocessing_tutorial.html">torchaudio Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">텍스트</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="transformer_tutorial.html">nn.Transformer 와 TorchText 로 시퀀스-투-시퀀스(Sequence-to-Sequence) 모델링하기</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/char_rnn_classification_tutorial.html">기초부터 시작하는 NLP: 문자-단위 RNN으로 이름 분류하기</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/char_rnn_generation_tutorial.html">기초부터 시작하는 NLP:  문자-단위 RNN으로 이름 생성하기</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/seq2seq_translation_tutorial.html">기초부터 시작하는 NLP: Sequence to Sequence 네트워크와 Attention을 이용한 번역</a></li>
<li class="toctree-l1"><a class="reference internal" href="text_sentiment_ngrams_tutorial.html">TorchText로 텍스트 분류하기</a></li>
<li class="toctree-l1"><a class="reference internal" href="torchtext_translation_tutorial.html">TorchText로 언어 번역하기</a></li>
</ul>
<p class="caption"><span class="caption-text">강화학습</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/reinforcement_q_learning.html">강화 학습 (DQN) 튜토리얼</a></li>
</ul>
<p class="caption"><span class="caption-text">PyTorch 모델을 프로덕션 환경에 배포하기</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intermediate/flask_rest_api_tutorial.html">Flask를 이용하여 Python에서 PyTorch를 REST API로 배포하기</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">TorchScript 소개</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_export.html">C++에서 TorchScript 모델 로딩하기</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/super_resolution_with_onnxruntime.html">(선택) PyTorch 모델을 ONNX으로 변환하고 ONNX 런타임에서 실행하기</a></li>
</ul>
<p class="caption"><span class="caption-text">프론트엔드 API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/named_tensor_tutorial.html">(prototype) Introduction to Named Tensors in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/memory_format_tutorial.html">(beta) Channels Last Memory Format in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_frontend.html">Using the PyTorch C++ Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_extension.html">Custom C++ and CUDA Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch_script_custom_ops.html">Extending TorchScript with Custom C++ Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch_script_custom_classes.html">Extending TorchScript with Custom C++ Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/torch-script-parallelism.html">Dynamic Parallelism in TorchScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/cpp_autograd.html">Autograd in C++ Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dispatcher.html">Dispatcher in C++</a></li>
</ul>
<p class="caption"><span class="caption-text">모델 최적화</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/pruning_tutorial.html">가지치기 기법(Pruning) 튜토리얼</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dynamic_quantization_tutorial.html">(beta) Dynamic Quantization on an LSTM Word Language Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dynamic_quantization_bert_tutorial.html">(베타) BERT 모델 동적 양자화하기</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/static_quantization_tutorial.html">(beta) Static Quantization with Eager Mode in PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/quantized_transfer_learning_tutorial.html">(beta) 컴퓨터 비전(Vision) 튜토리얼을 위한 양자화된 전이학습(Quantized Transfer Learning)</a></li>
</ul>
<p class="caption"><span class="caption-text">병렬 및 분산 학습</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dist_overview.html">PyTorch Distributed Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/model_parallel_tutorial.html">단일 머신을 이용한 모델 병렬화 실습 예제</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/ddp_tutorial.html">Getting Started with Distributed Data Parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dist_tuto.html">PyTorch로 분산 어플리케이션 개발하기</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_tutorial.html">Getting Started with Distributed RPC Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_distributed_training_tutorial.html">(advanced) PyTorch 1.0 Distributed Trainer with Amazon AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_param_server_tutorial.html">Implementing a Parameter Server Using Distributed RPC Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/dist_pipeline_parallel_tutorial.html">Distributed Pipeline Parallelism Using RPC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intermediate/rpc_async_execution.html">Implementing Batch RPC Processing Using Asynchronous Executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/rpc_ddp_tutorial.html">Combining Distributed DataParallel with Distributed RPC Framework</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Tutorials
          
        </a> &gt;
      </li>

        
      <li>TorchScript 소개</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="../_sources/beginner/Intro_to_TorchScript_tutorial.rst.txt" rel="nofollow"><img src="../_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        

          <div class="pytorch-call-to-action-links">
            <div id="tutorial-type">beginner/Intro_to_TorchScript_tutorial</div>

            <div id="google-colab-link">
              <img class="call-to-action-img" src="../_static/images/pytorch-colab.svg"/>
              <div class="call-to-action-desktop-view">Run in Google Colab</div>
              <div class="call-to-action-mobile-view">Colab</div>
            </div>
            <div id="download-notebook-link">
              <img class="call-to-action-notebook-img" src="../_static/images/pytorch-download.svg"/>
              <div class="call-to-action-desktop-view">Download Notebook</div>
              <div class="call-to-action-mobile-view">Notebook</div>
            </div>
            <div id="github-view-link">
              <img class="call-to-action-img" src="../_static/images/pytorch-github.svg"/>
              <div class="call-to-action-desktop-view">View on GitHub</div>
              <div class="call-to-action-mobile-view">GitHub</div>
            </div>
          </div>

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-beginner-intro-to-torchscript-tutorial-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="torchscript">
<span id="sphx-glr-beginner-intro-to-torchscript-tutorial-py"></span><h1>TorchScript 소개<a class="headerlink" href="#torchscript" title="Permalink to this headline">¶</a></h1>
<p><strong>Author</strong>: James Reed (<a class="reference external" href="mailto:jamesreed&#37;&#52;&#48;fb&#46;com">jamesreed<span>&#64;</span>fb<span>&#46;</span>com</a>), Michael Suo (<a class="reference external" href="mailto:suo&#37;&#52;&#48;fb&#46;com">suo<span>&#64;</span>fb<span>&#46;</span>com</a>), rev2</p>
<p><strong>번역</strong>: <a class="reference external" href="https://github.com/k1101jh">강준혁</a></p>
<p>이 튜토리얼은 C++와 같은 고성능 환경에서 실행될 수 있는
PyTorch 모델(<code class="docutils literal notranslate"><span class="pre">nn.Module</span></code> 의 하위클래스)의 중간 표현인
TorchScript에 대한 소개입니다.</p>
<p>이 튜토리얼에서는 다음을 다룰 것입니다:</p>
<ol class="arabic simple">
<li><p>다음을 포함한 PyTorch의 모델 제작의 기본:</p></li>
</ol>
<ul class="simple">
<li><p>모듈(Modules)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward</span></code> 함수 정의하기</p></li>
<li><p>모듈을 계층 구조로 구성하기</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>PyTorch 모듈을 고성능 배포 런타임인 TorchScript로 변환하는 특정 방법</p></li>
</ol>
<ul class="simple">
<li><p>기존 모듈 추적하기</p></li>
<li><p>스크립트를 사용하여 모듈을 직접 컴파일하기</p></li>
<li><p>두 가지 접근 방법을 구성하는 방법</p></li>
<li><p>TorchScript 모듈 저장 및 불러오기</p></li>
</ul>
<p>이 튜토리얼을 완료한 후에는
<a class="reference external" href="https://pytorch.org/tutorials/advanced/cpp_export.html">다음 학습서</a>
를 통해 C++에서 TorchScript 모델을 실제로 호출하는 예제를 안내합니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>  <span class="c1"># This is all you need to use both PyTorch and TorchScript!</span>
<span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>1.6.0
</pre></div>
</div>
<div class="section" id="pytorch">
<h2>PyTorch 모델 작성의 기초<a class="headerlink" href="#pytorch" title="Permalink to this headline">¶</a></h2>
<p>간단한 <code class="docutils literal notranslate"><span class="pre">Module</span></code> 을 정의하는 것부터 시작하겠습니다. <code class="docutils literal notranslate"><span class="pre">Module</span></code> 은 PyTorch의
기본 구성 단위입니다. 이것은 다음을 포함합니다:</p>
<ol class="arabic simple">
<li><p>호출을 위해 모듈을 준비하는 생성자</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Parameters</span></code> 집합과 하위 <code class="docutils literal notranslate"><span class="pre">Module</span></code> . 이것들은 생성자에 의해 초기화되며
호출 중에 모듈에 의해 사용될 수 있습니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward</span></code> 함수. 모듈이 호출될 때 실행되는 코드입니다.</p></li>
</ol>
<p>작은 예제로 시작해 보겟습니다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyCell</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyCell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="n">new_h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_h</span><span class="p">,</span> <span class="n">new_h</span>

<span class="n">my_cell</span> <span class="o">=</span> <span class="n">MyCell</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(tensor([[0.7637, 0.5457, 0.5066, 0.8010],
        [0.7981, 0.7785, 0.7362, 0.8155],
        [0.8635, 0.5365, 0.7909, 0.8748]]), tensor([[0.7637, 0.5457, 0.5066, 0.8010],
        [0.7981, 0.7785, 0.7362, 0.8155],
        [0.8635, 0.5365, 0.7909, 0.8748]]))
</pre></div>
</div>
<p>우리는 다음 작업을 수행했습니다.:</p>
<ol class="arabic simple">
<li><p>하위 클래스로 <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> 을 갖는 클래스를 생성했습니다.</p></li>
<li><p>생성자를 정의했습니다. 생성자는 많은 작업을 수행하지 않고 <code class="docutils literal notranslate"><span class="pre">super</span></code> 로
생성자를 호출합니다.</p></li>
<li><p>두 개의 입력을 받아 두 개의 출력을 반환하는 <code class="docutils literal notranslate"><span class="pre">forward</span></code> 함수를 정의했습니다.
<code class="docutils literal notranslate"><span class="pre">forward</span></code> 함수의 실제 내용은 크게 중요하진 않지만, 가짜 <a class="reference external" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">RNN
cell</a> 의
일종입니다. 즉, 반복(loop)에 적용되는 함수입니다.</p></li>
</ol>
<p>모듈을 인스턴스화하고, 3x4 크기의 무작위 값들로 이루어진 행렬 <code class="docutils literal notranslate"><span class="pre">x</span></code> 와 <code class="docutils literal notranslate"><span class="pre">y</span></code> 를
만들었습니다.
그런 다음, <code class="docutils literal notranslate"><span class="pre">my_cell(x,</span> <span class="pre">h)</span></code> 를 이용해 cell을 호출했습니다. 이것은 <code class="docutils literal notranslate"><span class="pre">forward</span></code>
함수를 호출합니다.</p>
<p>좀 더 흥미로운 것을 해봅시다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyCell</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyCell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="n">new_h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_h</span><span class="p">,</span> <span class="n">new_h</span>

<span class="n">my_cell</span> <span class="o">=</span> <span class="n">MyCell</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_cell</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>MyCell(
  (linear): Linear(in_features=4, out_features=4, bias=True)
)
(tensor([[0.7233, 0.1539, 0.1757, 0.5500],
        [0.5841, 0.2615, 0.2206, 0.6759],
        [0.6854, 0.3774, 0.5131, 0.7681]], grad_fn=&lt;TanhBackward&gt;), tensor([[0.7233, 0.1539, 0.1757, 0.5500],
        [0.5841, 0.2615, 0.2206, 0.6759],
        [0.6854, 0.3774, 0.5131, 0.7681]], grad_fn=&lt;TanhBackward&gt;))
</pre></div>
</div>
<p>모듈 <code class="docutils literal notranslate"><span class="pre">MyCell</span></code> 을 재정의했지만, 이번에는 <code class="docutils literal notranslate"><span class="pre">self.linear</span></code> 속성을 추가하고
forward 함수에서 <code class="docutils literal notranslate"><span class="pre">self.linear</span></code> 을 호출했습니다.</p>
<p>여기서 무슨 일이 일어날까요? <code class="docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code> 은 <code class="docutils literal notranslate"><span class="pre">MyCell</span></code> 과
마찬가지로 PyTorch 표준 라이브러리의 <code class="docutils literal notranslate"><span class="pre">Module</span></code> 입니다. 이것은 호출 구문을
사용하여 호출할 수 있습니다. 우리는 <code class="docutils literal notranslate"><span class="pre">Module</span></code> 의 계층을 구축하고 있습니다.</p>
<p><code class="docutils literal notranslate"><span class="pre">Module</span></code> 에서 <code class="docutils literal notranslate"><span class="pre">print</span></code> 하는 것은 <code class="docutils literal notranslate"><span class="pre">Module</span></code> 의 하위 클래스 계층에 대한
시각적 표현을 제공할 것입니다. 이 예제에서는 <code class="docutils literal notranslate"><span class="pre">Linear</span></code> 의 하위 클래스와
하위 클래스의 매개 변수를 볼 수 있습니다.</p>
<p><code class="docutils literal notranslate"><span class="pre">Module</span></code> 을 이런 방식으로 작성하면, 재사용 가능한 구성 요소를 사용하여
모델을 간결하고 읽기 쉽게 작성할 수 있습니다.</p>
<p>여러분은 출력된 내용에서 <code class="docutils literal notranslate"><span class="pre">grad_fn</span></code> 을 확인하셨을 것입니다. 이것은
<a class="reference external" href="https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html">오토그라드(autograd)</a>
라 불리는 PyTorch의 자동 미분 방법의 세부 정보입니다. 요컨데, 이 시스템은
잠재적으로 복잡한 프로그램을 통해 미분을 계산할 수 있게 합니다. 이 디자인은
모델 제작에 엄청난 유연성을 제공합니다.</p>
<p>이제 유연성을 시험해 보겠습니다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyDecisionGate</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">x</span>

<span class="k">class</span> <span class="nc">MyCell</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyCell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dg</span> <span class="o">=</span> <span class="n">MyDecisionGate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="n">new_h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_h</span><span class="p">,</span> <span class="n">new_h</span>

<span class="n">my_cell</span> <span class="o">=</span> <span class="n">MyCell</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_cell</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>MyCell(
  (dg): MyDecisionGate()
  (linear): Linear(in_features=4, out_features=4, bias=True)
)
(tensor([[0.7652, 0.3847, 0.5779, 0.4876],
        [0.5550, 0.7848, 0.6686, 0.7434],
        [0.6201, 0.6122, 0.8322, 0.7050]], grad_fn=&lt;TanhBackward&gt;), tensor([[0.7652, 0.3847, 0.5779, 0.4876],
        [0.5550, 0.7848, 0.6686, 0.7434],
        [0.6201, 0.6122, 0.8322, 0.7050]], grad_fn=&lt;TanhBackward&gt;))
</pre></div>
</div>
<p>MyCell 클래스를 다시 정의했지만, 여기선 <code class="docutils literal notranslate"><span class="pre">MyDecisionGate</span></code> 를 정의했습니다.
이 모듈은 <strong>제어 흐름</strong> 을 활용합니다. 제어 흐름은 루프와 <code class="docutils literal notranslate"><span class="pre">if</span></code> 명령문과
같은 것으로 구성됩니다.</p>
<p>많은 프레임워크들은 주어진 프로그램 코드로부터 기호식 미분(symbolic
derivatives)을 계산하는 접근법을 취하고 있습니다. 하지만, PyTorch에서는 변화도
테이프(gradient tape)를 사용합니다. 연산이 발생할 때 이를 기록하고, 미분값을
계산할 때 거꾸로 재생합니다. 이런 방식으로, 프레임워크는 언어의 모든 구문에
대한 미분값을 명시적으로 정의할 필요가 없습니다.</p>
<div class="figure align-default" id="id8">
<img alt="오토그라드가 작동하는 방식" src="https://github.com/pytorch/pytorch/raw/master/docs/source/_static/img/dynamic_graph.gif" />
<p class="caption"><span class="caption-text">오토그라드가 작동하는 방식</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="id3">
<h2>TorchScript의 기초<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>이제 실행 예제를 살펴보고 TorchScript를 적용하는 방법을 살펴보겠습니다.</p>
<p>한마디로, TorchScript는 PyTorch의 유연하고 동적인 특성을 고려하여 모델 정의를
캡쳐할 수 있는 도구를 제공합니다.
<strong>추적(tracing)</strong> 이라 부르는 것을 검사하는 것으로 시작하겠습니다.</p>
<div class="section" id="module">
<h3><code class="docutils literal notranslate"><span class="pre">Module</span></code> 추적<a class="headerlink" href="#module" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyCell</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyCell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="n">new_h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_h</span><span class="p">,</span> <span class="n">new_h</span>

<span class="n">my_cell</span> <span class="o">=</span> <span class="n">MyCell</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">traced_cell</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">my_cell</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traced_cell</span><span class="p">)</span>
<span class="n">traced_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>MyCell(
  original_name=MyCell
  (linear): Linear(original_name=Linear)
)
</pre></div>
</div>
<p>살짝 앞으로 돌아가 <code class="docutils literal notranslate"><span class="pre">MyCell</span></code> 의 두 번째 버전을 가져왔습니다. 이전에 이것을
인스턴스화 했지만 이번엔 <code class="docutils literal notranslate"><span class="pre">torch.jit.trace</span></code> 를 호출하고, <code class="docutils literal notranslate"><span class="pre">Module</span></code> 을
전달했으며, 네트워크가 볼 수 있는 <em>입력 예</em> 를 전달했습니다.</p>
<p>여기서 무슨 일이 발생했습니까? <code class="docutils literal notranslate"><span class="pre">Module</span></code> 을 호출하였고, <code class="docutils literal notranslate"><span class="pre">Module</span></code> 이 돌아갈 때
발생한 연산을 기록하였고, <code class="docutils literal notranslate"><span class="pre">torch.jit.ScriptModule</span></code> 의 인스터스를 생성했습니다.
( <code class="docutils literal notranslate"><span class="pre">TracedModule</span></code> 은 인스턴스입니다)</p>
<p>TorchScript는 일반적으로 딥 러닝에서 <em>그래프</em> 라고 하는 중간 표현(또는 IR)에
정의를 기록합니다. <code class="docutils literal notranslate"><span class="pre">.graph</span></code> 속성으로 그래프를 확인해볼 수 있습니다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traced_cell</span><span class="o">.</span><span class="n">graph</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>graph(%self.1 : __torch__.MyCell,
      %input : Float(3:4, 4:1),
      %h : Float(3:4, 4:1)):
  %19 : __torch__.torch.nn.modules.linear.Linear = prim::GetAttr[name=&quot;linear&quot;](%self.1)
  %21 : Tensor = prim::CallMethod[name=&quot;forward&quot;](%19, %input)
  %12 : int = prim::Constant[value=1]() # /home/reserve/Workspace/PyTorch-tutorials-kr/beginner_source/Intro_to_TorchScript_tutorial.py:184:0
  %13 : Float(3:4, 4:1) = aten::add(%21, %h, %12) # /home/reserve/Workspace/PyTorch-tutorials-kr/beginner_source/Intro_to_TorchScript_tutorial.py:184:0
  %14 : Float(3:4, 4:1) = aten::tanh(%13) # /home/reserve/Workspace/PyTorch-tutorials-kr/beginner_source/Intro_to_TorchScript_tutorial.py:184:0
  %15 : (Float(3:4, 4:1), Float(3:4, 4:1)) = prim::TupleConstruct(%14, %14)
  return (%15)
</pre></div>
</div>
<p>그러나, 이것은 저수준의 표현이며 그래프에 포함된 대부분의 정보는
최종 사용자에게 유용하지 않습니다. 대신, <code class="docutils literal notranslate"><span class="pre">.code</span></code> 속성을 사용하여 코드에
대한 Python 구문 해석을 제공할 수 있습니다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">traced_cell</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>def forward(self,
    input: Tensor,
    h: Tensor) -&gt; Tuple[Tensor, Tensor]:
  _0 = torch.add((self.linear).forward(input, ), h, alpha=1)
  _1 = torch.tanh(_0)
  return (_1, _1)
</pre></div>
</div>
<p><strong>어째서</strong> 이런 일들을 했을까요? 여기에는 몇 가지 이유가 있습니다:</p>
<ol class="arabic simple">
<li><p>TorchScript 코드는 기본적으로 제한된 Python 인터프리터인 자체 인터프리터에서
호출될 수 있습니다. 이 인터프리터는 GIL(Global Interpreter Lock)을 얻지
않으므로 동일한 인스턴스에서 동시에 많은 요청을 처리할 수 있습니다.</p></li>
<li><p>이 형식을 사용하면 전체 모델을 디스크에 저장하고 Python 이외의 언어로 작성된
서버와 같은 다른 환경에서 불러올 수 있습니다.</p></li>
<li><p>TorchScript는 보다 효율적인 실행을 제공하기 위해 코드에서 컴파일러 최적화를
수행할 수 있는 표현을 제공합니다.</p></li>
<li><p>TorchScript를 사용하면 개별 연산자보다 프로그램의 더 넓은 관점을 요구하는 많은
백엔드/장치 런타임과 상호작용(interface)할 수 있습니다.</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">traced_cell</span></code> 을 호출하면 Python 모듈과 동일한 결과가 생성됩니다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">my_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traced_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(tensor([[ 0.2711,  0.3308,  0.7184,  0.8275],
        [ 0.7674, -0.5661,  0.7969,  0.6040],
        [ 0.7650, -0.1235,  0.6603,  0.7080]], grad_fn=&lt;TanhBackward&gt;), tensor([[ 0.2711,  0.3308,  0.7184,  0.8275],
        [ 0.7674, -0.5661,  0.7969,  0.6040],
        [ 0.7650, -0.1235,  0.6603,  0.7080]], grad_fn=&lt;TanhBackward&gt;))
(tensor([[ 0.2711,  0.3308,  0.7184,  0.8275],
        [ 0.7674, -0.5661,  0.7969,  0.6040],
        [ 0.7650, -0.1235,  0.6603,  0.7080]],
       grad_fn=&lt;DifferentiableGraphBackward&gt;), tensor([[ 0.2711,  0.3308,  0.7184,  0.8275],
        [ 0.7674, -0.5661,  0.7969,  0.6040],
        [ 0.7650, -0.1235,  0.6603,  0.7080]],
       grad_fn=&lt;DifferentiableGraphBackward&gt;))
</pre></div>
</div>
</div>
</div>
<div class="section" id="id4">
<h2>스크립팅을 사용하여 모듈 변환<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>제어 흐름이 포함된(control-flow-laden) 하위 모듈이 아닌 모듈 버전 2를 사용하는
이유가 있습니다. 지금 살펴봅시다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyDecisionGate</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">x</span>

<span class="k">class</span> <span class="nc">MyCell</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dg</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyCell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dg</span> <span class="o">=</span> <span class="n">dg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
        <span class="n">new_h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_h</span><span class="p">,</span> <span class="n">new_h</span>

<span class="n">my_cell</span> <span class="o">=</span> <span class="n">MyCell</span><span class="p">(</span><span class="n">MyDecisionGate</span><span class="p">())</span>
<span class="n">traced_cell</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">my_cell</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traced_cell</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>def forward(self,
    input: Tensor,
    h: Tensor) -&gt; Tuple[Tensor, Tensor]:
  _0 = self.dg
  _1 = (self.linear).forward(input, )
  _2 = (_0).forward(_1, )
  _3 = torch.tanh(torch.add(_1, h, alpha=1))
  return (_3, _3)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.code</span></code> 출력을 보면, <code class="docutils literal notranslate"><span class="pre">if-else</span></code> 분기가 어디에도 없다는 것을 알 수 있습니다!
어째서일까요? 추적은 코드를 실행하고 <em>발생하는</em> 작업을 기록하며 정확하게 수행하는
스크립트 모듈(ScriptModule)을 구성하는 일을 수행합니다. 불행하게도, 제어 흐름과
같은 것들은 지워집니다.</p>
<p>TorchScript에서 이 모듈을 어떻게 충실하게 나타낼 수 있을까요? Python 소스 코드를
직접 분석하여 TorchScript로 변환하는 <strong>스크립트 컴파일러(script compiler)</strong> 를
제공합니다. <code class="docutils literal notranslate"><span class="pre">MyDecisionGate</span></code> 를 스크립트 컴파일러를 사용하여 변환해 봅시다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scripted_gate</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span><span class="p">(</span><span class="n">MyDecisionGate</span><span class="p">())</span>

<span class="n">my_cell</span> <span class="o">=</span> <span class="n">MyCell</span><span class="p">(</span><span class="n">scripted_gate</span><span class="p">)</span>
<span class="n">traced_cell</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span><span class="p">(</span><span class="n">my_cell</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traced_cell</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>def forward(self,
    x: Tensor,
    h: Tensor) -&gt; Tuple[Tensor, Tensor]:
  _0 = (self.dg).forward((self.linear).forward(x, ), )
  new_h = torch.tanh(torch.add(_0, h, alpha=1))
  return (new_h, new_h)
</pre></div>
</div>
<p>만세! 이제 TorchScript에서 프로그램의 동작을 충실하게 캡쳐했습니다. 이제
프로그램을 실행해 봅시다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># 새로운 입력</span>
<span class="n">x</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">traced_cell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id5">
<h3>스크립팅과 추적 혼합<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>어떤 상황에서는 스크립팅보다는 추적을 사용해야 합니다. (예: 모듈에는 TorchScript에
표시하지 않으려는 Python 상수 값을 기반으로 만들어진 많은 구조적인
결정(architectural decisions)이 있습니다.) 이 경우, 스크립팅은 추적으로
구성될 수 있습니다: <code class="docutils literal notranslate"><span class="pre">torch.jit.script</span></code> 는 추적된 모듈의 코드를 인라인(inline)
할 것이고, 추적은 스크립트 된 모듈의 코드를 인라인 할 것입니다.</p>
<p>첫 번째 경우의 예:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyRNNLoop</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyRNNLoop</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">MyCell</span><span class="p">(</span><span class="n">scripted_gate</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">):</span>
        <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
            <span class="n">y</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">h</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span>

<span class="n">rnn_loop</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span><span class="p">(</span><span class="n">MyRNNLoop</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rnn_loop</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>def forward(self,
    xs: Tensor) -&gt; Tuple[Tensor, Tensor]:
  h = torch.zeros([3, 4], dtype=None, layout=None, device=None, pin_memory=None)
  y = torch.zeros([3, 4], dtype=None, layout=None, device=None, pin_memory=None)
  y0 = y
  h0 = h
  for i in range(torch.size(xs, 0)):
    _0 = (self.cell).forward(torch.select(xs, 0, i), h0, )
    y1, h1, = _0
    y0, h0 = y1, h1
  return (y0, h0)
</pre></div>
</div>
<p>두 번째 경우의 예:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">WrapRNN</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WrapRNN</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loop</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span><span class="p">(</span><span class="n">MyRNNLoop</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">):</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loop</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">traced</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">WrapRNN</span><span class="p">(),</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traced</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>def forward(self,
    argument_1: Tensor) -&gt; Tensor:
  _0, h, = (self.loop).forward(argument_1, )
  return torch.relu(h)
</pre></div>
</div>
<p>이러한 방식으로, 스크립팅과 추적은 상황에 따라서 따로 사용되거나, 함께
사용될 수 있습니다.</p>
</div>
</div>
<div class="section" id="id6">
<h2>모델 저장 및 불러오기<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>TorchScript 모듈을 아카이브 형식으로 디스크에 저장하고 불러오는 API를 제공합니다.
이 형식은 코드, 매개 변수, 속성과 디버그 정보를 포함합니다. 이것은 그 아카이브가
완전히 별개의 프로세스로 로드할 수 있는 모델의 독립 표현임을 의미합니다.
랩핑 된 RNN 모듈을 저장하고 로드해 봅시다:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">traced</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;wrapped_rnn.zip&#39;</span><span class="p">)</span>

<span class="n">loaded</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;wrapped_rnn.zip&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">loaded</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loaded</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>RecursiveScriptModule(
  original_name=WrapRNN
  (loop): RecursiveScriptModule(
    original_name=MyRNNLoop
    (cell): RecursiveScriptModule(
      original_name=MyCell
      (dg): RecursiveScriptModule(original_name=MyDecisionGate)
      (linear): RecursiveScriptModule(original_name=Linear)
    )
  )
)
def forward(self,
    argument_1: Tensor) -&gt; Tensor:
  _0, h, = (self.loop).forward(argument_1, )
  return torch.relu(h)
</pre></div>
</div>
<p>보시다시피, 직렬화는 모듈 계층과 검사한 코드를 유지합니다. 또한 모델을 로드할
수 있습니다. 예를 들어, Python 없이 실행하기 위해 모델을
<a class="reference external" href="https://pytorch.org/tutorials/advanced/cpp_export.html">C++</a> 로 로드할
수 있습니다.</p>
<div class="section" id="id7">
<h3>더 읽을거리<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>튜토리얼을 완료했습니다! 관련 데모를 보려면 TorchScript를 사용하여 기계 번역
모델을 변환하기 위한 NeurIPS 데모를 확인하십시오:
<a class="reference external" href="https://colab.research.google.com/drive/1HiICg6jRkBnr5hvK2-VnMi88Vi9pUzEJ">https://colab.research.google.com/drive/1HiICg6jRkBnr5hvK2-VnMi88Vi9pUzEJ</a></p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.927 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-beginner-intro-to-torchscript-tutorial-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/07d05907b3ff859aeed5f76f1acc5df4/Intro_to_TorchScript_tutorial.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">Intro_to_TorchScript_tutorial.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/61a76849444a0a65d843361c26d1de16/Intro_to_TorchScript_tutorial.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">Intro_to_TorchScript_tutorial.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../advanced/cpp_export.html" class="btn btn-neutral float-right" title="C++에서 TorchScript 모델 로딩하기" accesskey="n" rel="next">Next <img src="../_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="../intermediate/flask_rest_api_tutorial.html" class="btn btn-neutral" title="Flask를 이용하여 Python에서 PyTorch를 REST API로 배포하기" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr class="helpful-hr hr-top">
      <div class="helpful-container">
        <div class="helpful-question">이 문서가 도움이 되었나요?</div>
        <div class="helpful-question yes-link" data-behavior="was-this-helpful-event" data-response="yes">네</div>
        <div class="helpful-question no-link" data-behavior="was-this-helpful-event" data-response="no">아니오</div>
        <div class="was-helpful-thank-you">피드백을 주셔서 감사합니다.</div>
      </div>
    <hr class="helpful-hr hr-bottom"/>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, PyTorch.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">TorchScript 소개</a><ul>
<li><a class="reference internal" href="#pytorch">PyTorch 모델 작성의 기초</a></li>
<li><a class="reference internal" href="#id3">TorchScript의 기초</a><ul>
<li><a class="reference internal" href="#module"><code class="docutils literal notranslate"><span class="pre">Module</span></code> 추적</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id4">스크립팅을 사용하여 모듈 변환</a><ul>
<li><a class="reference internal" href="#id5">스크립팅과 추적 혼합</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id6">모델 저장 및 불러오기</a><ul>
<li><a class="reference internal" href="#id7">더 읽을거리</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script type="text/javascript" src="../_static/jquery.js"></script>
         <script type="text/javascript" src="../_static/underscore.js"></script>
         <script type="text/javascript" src="../_static/doctools.js"></script>
         <script type="text/javascript" src="../_static/language_data.js"></script>
         <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-71919972-3', 'auto');
  ga('send', 'pageview');

  $("[data-behavior='call-to-action-event']").on('click', function(){
    ga('send', {
      hitType: 'event',
      eventCategory: 'Download',
      eventAction: 'click',
      eventLabel: $(this).attr("data-response")
    });
   });

   $("[data-behavior='was-this-helpful-event']").on('click', function(){
    $(".helpful-question").hide();
    $(".was-helpful-thank-you").show();
    ga('send', {
      hitType: 'event',
      eventCategory: 'Was this Helpful?',
      eventAction: 'click',
      eventLabel: $(this).attr("data-response")
    });
   });

   if (location.pathname == "/") {
     $(".helpful-container").hide();
     $(".hr-bottom").hide();
   }
</script>


  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="footer-container container">
      <div class="footer-logo-wrapper"><a href="https://pytorch.kr" class="footer-logo"></a></div>
      <div class="footer-links-wrapper pb-2">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org">PyTorch 홈페이지 (공식)</a></li>
            <li><a href="https://pytorch.org">공식 홈페이지</a></li>
            <li><a href="https://pytorch.org/tutorials">공식 튜토리얼</a></li>
            <li><a href="https://pytorch.org/docs">공식 문서</a></li>
          </ul>
        </div>
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.kr">한국어 홈페이지 (비공식)</a></li>
            <li><a href="https://pytorch.kr/about" class="">사이트 소개</a></li>
            <li><a href="https://tutorials.pytorch.kr/">한국어 튜토리얼</a></li>
            <li><a href="https://github.com/9bow/PyTorch-tutorials-kr" target="_blank">한국어 튜토리얼 저장소</a></li>
          </ul>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.kr/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/features">Features</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/hub">PyTorch Hub</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li class="active">
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li>
            <a href="https://pytorch.org/docs/stable/index.html">Docs</a>
          </li>

          <li>
            <a href="https://pytorch.org/resources">Resources</a>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>